# Принцип работы двухфакторной аутентификации для OpenVPN 

 а. С помощью утилиты otpauth генерируются 6-ти значные коды каждые 30 секунд

 б. Авторизация происходит в несколько этапов
   1. Проверка сертификата
   2. Проверка логина
   3. Проверка пароля
   4. Проверка персонального токена двухфакторки

 в. Проверку вышеперечислиных параметров выполняет скрипт oath.sh, он пулучает все параметры и сверяет их с данными в файлах user_creditians.txt и 
oath.secrets 

# Принцип работы двухфакторной аутентификации для OpenVPN с LDAP

 а. С помощью утилиты otpauth генерируются 6-ти значные коды каждые 30 секунд

 б. Авторизация происходит в несколько этапов
   1. Проверка сертификата
   2. Проверка логина LDAP
   3. Проверка пароля LDAP
   4. Проверка персонального токена двухфакторки

 в. Проверку вышеперечислиных параметров выполняет скрипт oath.sh, скрипт сравнивает логин и пароль с хранящимся на ldap-сервере с помощью утилиты ldapsearch, если LDAP сервер подтвердает,что такой пользователь есть и пароль ввёден верно, скрипт проверяет секрет в файле oath.secrets и потдверждает авторизацию
